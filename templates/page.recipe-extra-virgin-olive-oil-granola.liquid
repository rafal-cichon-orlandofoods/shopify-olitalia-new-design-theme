{{ 'recipe-page.css' | asset_url | stylesheet_tag }}
<script src="{{ 'recipe-print.js' | asset_url }}" defer></script>
<script src="{{ 'recipe-interactions.js' | asset_url }}" defer></script>

{% comment %} Get recipe data from metafields with fallbacks {% endcomment %}
{% assign recipe_image = page.metafields.recipe.featured_image | default: 'https://cdn.shopify.com/s/files/1/0766/7109/0927/files/Granola_Final_Website.jpg?v=1761682009' %}
{% assign recipe_category = page.metafields.recipe.category | default: 'Dolci' %}
{% assign recipe_difficulty = page.metafields.recipe.difficulty | default: 'Easy' %}
{% assign recipe_title = page.title %}
{% assign recipe_chef = page.metafields.recipe.chef_name | default: 'Michele Loffreno' %}
{% assign recipe_chef_url = page.metafields.recipe.chef_page_url | default: '/pages/chefs' %}
{% assign recipe_description = page.metafields.recipe.description | default: 'Golden, irresistible EVOO granola made with the finest Olitalia Extra Virgin Olive Oil. Simple to make and rich in flavor, this is the kind of granola you\'ll crave daily.' %}
{% assign recipe_time = page.metafields.recipe.total_time | default: '35 Minutes' %}
{% assign recipe_servings = page.metafields.recipe.servings | default: '8-10 Servings' %}
{% assign recipe_ingredients = page.metafields.recipe.ingredients %}
{% assign recipe_instructions = page.metafields.recipe.instructions %}

<div class="recipe-page">
  <div class="container container--large">
    
    <!-- Featured Image -->
    <div class="recipe-featured-image gutter-bottom--large">
      {% if recipe_image contains 'cdn.shopify.com' %}
        <img src="{{ recipe_image }}" 
             alt="{{ recipe_title }}"
             class="recipe-image">
      {% else %}
        <img src="{{ recipe_image | image_url: width: 1200 }}" 
             alt="{{ recipe_title }}"
             class="recipe-image">
      {% endif %}
    </div>
    
    <!-- Recipe Header -->
    <div class="recipe-header gutter-bottom--xlarge">
      <div class="recipe-header__content">
        <div class="recipe-meta gutter-bottom--regular">
          <span class="recipe-category">{{ recipe_category }}</span>
          <span class="recipe-difficulty">{{ recipe_difficulty }}</span>
        </div>
        
        <h1 class="recipe-title text-size--xxlarge text-weight--bold gutter-bottom--regular">
          {{ recipe_title }}
        </h1>
        
        <div class="recipe-chef gutter-bottom--regular">
          <span class="text-size--regular text-color--subdued">{{ 'recipes.by_chef' | t }}</span>
          <a href="{{ recipe_chef_url }}" class="text-size--regular text-weight--medium chef-profile-link">{{ recipe_chef }}</a>
        </div>
        
        <p class="recipe-description text-size--large text-line-height--medium gutter-bottom--large">
          {{ recipe_description }}
        </p>
        
        <!-- Recipe Action Buttons -->
        <div class="recipe-actions gutter-bottom--regular">
          <button class="print-recipe-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9V2H18V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M6 18H4C3.44772 18 3 17.5523 3 17V11C3 10.4477 3.44772 10 4 10H20C20.5523 10 21 10.4477 21 11V17C21 17.5523 20.5523 18 20 18H18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M6 14H18V22H6V14Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Print Recipe
          </button>
          
          <button class="reset-progress-btn" onclick="window.recipeInteractions?.resetProgress()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 12A9 9 0 0 1 12 3A9 9 0 0 1 21 12A9 9 0 0 1 12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M8 12L12 16L16 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Reset Progress
          </button>
        </div>
        
        <!-- Recipe Stats -->
        <div class="recipe-stats">
          <div class="recipe-stats__grid">
            <div class="recipe-stat">
              <div class="recipe-stat__icon">
                {% render 'icon-clock' %}
              </div>
              <div class="recipe-stat__content">
                <span class="recipe-stat__label">{{ 'recipes.total_time' | t }}</span>
                <span class="recipe-stat__value">{{ recipe_time }}</span>
              </div>
            </div>
            
            <div class="recipe-stat">
              <div class="recipe-stat__icon">
                {% render 'icon-users' %}
              </div>
              <div class="recipe-stat__content">
                <span class="recipe-stat__label">{{ 'recipes.servings' | t }}</span>
                <span class="recipe-stat__value">{{ recipe_servings }}</span>
              </div>
            </div>
            
            <div class="recipe-stat">
              <div class="recipe-stat__icon">
                {% render 'icon-chef-hat' %}
              </div>
              <div class="recipe-stat__content">
                <span class="recipe-stat__label">{{ 'recipes.difficulty_label' | t }}</span>
                <span class="recipe-stat__value">{{ recipe_difficulty }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Recipe Content -->
    <div class="recipe-content">
      <div class="recipe-content__grid">
        
        <!-- Ingredients -->
        <div class="recipe-ingredients">
          <h2 class="text-size--xlarge text-weight--bold gutter-bottom--regular">
            {{ 'recipes.ingredients' | t }}
          </h2>
          
          <ul class="recipe-ingredients__list">
            {% if recipe_ingredients %}
              {% for ingredient in recipe_ingredients %}
                <li class="recipe-ingredient{% if ingredient.featured %} recipe-ingredient--featured{% endif %}">
                  <span class="recipe-ingredient__amount">{{ ingredient.amount }}</span>
                  <span class="recipe-ingredient__name">{{ ingredient.name }}</span>
                </li>
              {% endfor %}
            {% else %}
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">4 Cups</span>
                <span class="recipe-ingredient__name">Rolled Oats</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">½ Cup</span>
                <span class="recipe-ingredient__name">Pecans, coarsely chopped</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">½ Cup</span>
                <span class="recipe-ingredient__name">Walnuts, coarsely chopped</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">⅓ Cup</span>
                <span class="recipe-ingredient__name">Pumpkin Seeds</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">1 Cup</span>
                <span class="recipe-ingredient__name">Coconut Flakes, unsweetened</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">½ Cup</span>
                <span class="recipe-ingredient__name">Coconut Sugar</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">¼ Teaspoon</span>
                <span class="recipe-ingredient__name">Cinnamon</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">¼ Teaspoon</span>
                <span class="recipe-ingredient__name">Cardamom, optional</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">½ Teaspoon</span>
                <span class="recipe-ingredient__name">Salt</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">1 Cup</span>
                <span class="recipe-ingredient__name">Maple Syrup</span>
              </li>
              <li class="recipe-ingredient">
                <span class="recipe-ingredient__amount">1 Teaspoon</span>
                <span class="recipe-ingredient__name">Vanilla Bean Paste</span>
              </li>
              <li class="recipe-ingredient recipe-ingredient--featured">
                <span class="recipe-ingredient__amount">½ Cup</span>
                <span class="recipe-ingredient__name">Olitalia Extra Virgin Olive Oil</span>
              </li>
            {% endif %}
          </ul>
        </div>
        
        <!-- Instructions -->
        <div class="recipe-instructions">
          <h2 class="text-size--xlarge text-weight--bold gutter-bottom--regular">
            {{ 'recipes.directions' | t }}
          </h2>
          
          <ol class="recipe-instructions__list">
            {% if recipe_instructions %}
              {% for instruction in recipe_instructions %}
                <li class="recipe-instruction">
                  <div class="recipe-instruction__number">{{ forloop.index }}</div>
                  <div class="recipe-instruction__content">
                    <p>{{ instruction.step }}</p>
                  </div>
                </li>
              {% endfor %}
            {% else %}
              <li class="recipe-instruction">
                <div class="recipe-instruction__number">1</div>
                <div class="recipe-instruction__content">
                  <p>Preheat the oven to 300 degrees F.</p>
                </div>
              </li>
              <li class="recipe-instruction">
                <div class="recipe-instruction__number">2</div>
                <div class="recipe-instruction__content">
                  <p>In a large bowl combine oats, pecans, walnuts, pumpkin seeds, coconut flakes, coconut sugar, cinnamon, cardamom, salt, maple syrup, vanilla bean paste and Olitalia Extra Virgin Olive Oil. Mix to combine.</p>
                </div>
              </li>
              <li class="recipe-instruction">
                <div class="recipe-instruction__number">3</div>
                <div class="recipe-instruction__content">
                  <p>Divide mixture into 2 half sheet trays and place in the oven for 30 minutes, mixing each sheet tray halfway through baking to ensure even cooking.</p>
                </div>
              </li>
              <li class="recipe-instruction">
                <div class="recipe-instruction__number">4</div>
                <div class="recipe-instruction__content">
                  <p>Allow to cool and store for up to 2 weeks on the counter in an airtight container or 3 months in the fridge.</p>
                </div>
              </li>
            {% endif %}
          </ol>
        </div>
      </div>
    </div>
    
    <!-- Featured Product -->
    <div class="recipe-featured-product gutter-top--xlarge">
      <div class="featured-product-card">
        <h3 class="text-size--large text-weight--bold gutter-bottom--regular">
          {{ 'recipes.featured_product' | t }}
        </h3>
        <p class="text-size--regular gutter-bottom--regular">
          This granola showcases the versatility of our Extra Virgin Olive Oil - perfect for creating healthy, flavorful breakfast treats with a rich, nutty finish.
        </p>
        <a href="https://usa.olitalia.com/products/extra-virgin-olive-oil-500ml" class="button button--solid" target="_blank" rel="noopener">
          {{ 'recipes.shop_ingredient' | t }}
        </a>
      </div>
    </div>
    
  </div>
</div>