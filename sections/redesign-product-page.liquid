{{ 'redesign-product-page.css' | asset_url | stylesheet_tag }}

<section class="redesign-product">
  <div class="redesign-product__container">
    <div class="redesign-product__media">
      <div class="redesign-product__main-image">
        {% if product.featured_media %}
          <img 
            src="{{ product.featured_media | image_url: width: 800 }}" 
            alt="{{ product.featured_media.alt | escape }}"
            id="main-product-image"
          >
        {% endif %}
      </div>
      
      {% if product.media.size > 1 %}
        <div class="redesign-product__thumbnails-wrapper">
          <button class="redesign-product__thumbnails-arrow redesign-product__thumbnails-arrow--prev" onclick="scrollThumbnails(-1)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
            </svg>
          </button>
          
          <div class="redesign-product__thumbnails">
            {% for media in product.media %}
              <button 
                class="redesign-product__thumbnail {% if forloop.first %}active{% endif %}"
                onclick="changeImage('{{ media | image_url: width: 800 }}', this)"
              >
                <img src="{{ media | image_url: width: 150 }}" alt="{{ media.alt | escape }}">
              </button>
            {% endfor %}
          </div>
          
          <button class="redesign-product__thumbnails-arrow redesign-product__thumbnails-arrow--next" onclick="scrollThumbnails(1)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
              <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
            </svg>
          </button>
        </div>
      {% endif %}
    </div>

    <div class="redesign-product__info">
      <h1 class="redesign-product__title">{{ product.title }}</h1>
      
      {% if section.settings.intro_text != blank %}
        <div class="redesign-product__intro-text">
          {{ section.settings.intro_text }}
        </div>
      {% endif %}

      <div class="redesign-product__price">
        {{ product.price | money }}
      </div>

      {% form 'product', product %}
        <div class="redesign-product__buttons-row">
          <div class="redesign-product__quantity-wrapper">
            <label for="quantity" class="redesign-product__quantity-label">Quantity</label>
            <div class="redesign-product__quantity-selector">
              <button type="button" class="redesign-product__quantity-btn" onclick="updateQuantity(-1)">âˆ’</button>
              <input type="number" id="quantity" name="quantity" value="1" min="1" class="redesign-product__quantity-input">
              <button type="button" class="redesign-product__quantity-btn" onclick="updateQuantity(1)">+</button>
            </div>
          </div>
          
          <button type="submit" name="add" class="redesign-product__add-to-cart">
            Add to Cart
          </button>
        </div>
        
        <button type="submit" name="checkout" class="redesign-product__buy-now">
          Buy it Now
        </button>
      {% endform %}
      
      {% if section.settings.description_text != blank %}
        <div class="redesign-product__description">
          {{ section.settings.description_text }}
        </div>
      {% endif %}
      
      {% if section.settings.product_highlights != blank %}
        <div class="redesign-product__highlights">
          {{ section.settings.product_highlights }}
        </div>
      {% endif %}

      {% if section.settings.show_accordions %}
        <div class="redesign-product__accordions">
          {% if section.settings.care_text != blank %}
            <details class="redesign-product__accordion">
              <summary>{{ section.settings.care_title | default: 'Care and Storage' }}</summary>
              <div class="redesign-product__accordion-content">
                {{ section.settings.care_text }}
              </div>
            </details>
          {% endif %}

          {% if section.settings.ingredients_text != blank %}
            <details class="redesign-product__accordion">
              <summary>{{ section.settings.ingredients_title | default: 'Ingredients' }}</summary>
              <div class="redesign-product__accordion-content">
                {{ section.settings.ingredients_text }}
              </div>
            </details>
          {% endif %}

          {% if section.settings.certifications_text != blank %}
            <details class="redesign-product__accordion">
              <summary>{{ section.settings.certifications_title | default: 'Certifications/Quality/Assurance' }}</summary>
              <div class="redesign-product__accordion-content">
                {{ section.settings.certifications_text }}
              </div>
            </details>
          {% endif %}
        </div>
      {% endif %}

      <div class="redesign-product__share">
        <span>Share</span>
        <a href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url }}{{ product.url }}" target="_blank">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </a>
        <a href="https://twitter.com/intent/tweet?url={{ shop.url }}{{ product.url }}&text={{ product.title }}" target="_blank">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
          </svg>
        </a>
        <a href="https://pinterest.com/pin/create/button/?url={{ shop.url }}{{ product.url }}&media={{ product.featured_image | image_url: width: 1000 }}&description={{ product.title }}" target="_blank">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
function changeImage(src, button) {
  document.getElementById('main-product-image').src = src;
  document.querySelectorAll('.redesign-product__thumbnail').forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');
}

function scrollThumbnails(direction) {
  const container = document.querySelector('.redesign-product__thumbnails');
  const thumbnails = container.querySelectorAll('.redesign-product__thumbnail');
  const activeThumbnail = container.querySelector('.redesign-product__thumbnail.active');
  
function updateQuantity(change) {
  const input = document.getElementById('quantity');
  const currentValue = parseInt(input.value) || 1;
  const newValue = Math.max(1, currentValue + change);
  input.value = newValue;
}
  
  let currentIndex = Array.from(thumbnails).indexOf(activeThumbnail);
  let nextIndex = currentIndex + direction;
  
  // Loop around if at the end
  if (nextIndex < 0) {
    nextIndex = thumbnails.length - 1;
  } else if (nextIndex >= thumbnails.length) {
    nextIndex = 0;
  }
  
  // Click the next thumbnail to change the image
  thumbnails[nextIndex].click();
  
  // Scroll to show the thumbnail
  thumbnails[nextIndex].scrollIntoView({
    behavior: 'smooth',
    block: 'nearest',
    inline: 'center'
  });
}
</script>

{% schema %}
{
  "name": "Redesign Product Page",
  "settings": [
    {
      "type": "richtext",
      "id": "intro_text",
      "label": "Introduction Text",
      "info": "Text displayed below the product title and above price"
    },
    {
      "type": "richtext",
      "id": "description_text",
      "label": "Description Text",
      "info": "Text displayed after the Buy it Now button"
    },
    {
      "type": "checkbox",
      "id": "show_accordions",
      "label": "Show Accordion Sections",
      "default": true
    },
    {
      "type": "text",
      "id": "care_title",
      "label": "Care Section Title",
      "default": "Care and Storage"
    },
    {
      "type": "richtext",
      "id": "care_text",
      "label": "Care Section Content"
    },
    {
      "type": "text",
      "id": "ingredients_title",
      "label": "Ingredients Section Title",
      "default": "Ingredients"
    },
    {
      "type": "richtext",
      "id": "ingredients_text",
      "label": "Ingredients Section Content"
    },
    {
      "type": "text",
      "id": "certifications_title",
      "label": "Certifications Section Title",
      "default": "Certifications/Quality/Assurance"
    },
    {
      "type": "richtext",
      "id": "certifications_text",
      "label": "Certifications Section Content"
    },
    {
      "type": "richtext",
      "id": "product_highlights",
      "label": "Product Highlights",
      "info": "Additional product information displayed below description"
    }
  ]
}
{% endschema %}
