<div
  id="element-{{ block.id }}"
  class="card card--fullwidth {% if section.settings.is_fullwidth %} card--no-radius {% endif %} card--no-borders js-slider-item"
  {{ block.shopify_attributes }}
>
  {%- if block.settings.link != blank -%}
    <a
      href="{{ block.settings.link }}"
      class="card__whole-link card__whole-link--alternate"
      aria-hidden="true"
      {% if block.settings.open_in_new_window %}
        target="_blank"
      {% endif %}
    ></a>
  {%- endif -%}

  <div class="{% if section.settings.is_fullwidth %} container--large gutter-top--xlarge gutter-bottom--xlarge container--large-with-mobile-padding {% endif %} align-content align-content--{{ section.settings.alignment }} card__text-parent">
    <div
      class="card__text {% unless section.settings.is_fullwidth %} gutter--xlarge {% endunless %} spacing--custom remove-empty-space"
      style="--horizontal-alignment:{{ section.settings.alignment | split: ' ' | first | replace: 'horizontal-', '' }}; --spacing:{{ section.settings.spacing }}px; mix-blend-mode: {{ section.settings.text_blend_mode }}"
    >
      {% content_for 'blocks' %}
    </div>
  </div>

  <div
    class="
      card__image card__image--background js-slider-animation
      {% if block.settings.color_background_main != "rgba(0,0,0,0)" %}
        card__image--with-overlay card__image--with-overlay--fullopacity
          {% if section.settings.is_auto_height %} card__image--with-overlay-z-index {% endif %}
      {% endif %}
    "
  >
    {%- unless block.settings.image == blank -%}
      {%- unless section.settings.is_auto_height -%}
        {%- liquid
          assign image_type = 'background'
          assign image_alignment = true
        -%}
        {%- capture sizes -%}
          sizes="(max-width: 1023px) calc({{ section.settings.mobile_height }} * {{ block.settings.image.aspect_ratio }}), calc({{ section.settings.desktop_height }} * {{ block.settings.image.aspect_ratio }})"
        {%- endcapture -%}
      {%- else -%}
        {%- if section.settings.is_fullwidth -%}
          {%- assign sizes = 'sizes="100vw"' -%}
        {%- else -%}
          {%- capture sizes -%}
            sizes="(max-width: {{ settings.theme_max_width }}px) calc(100vw - 30px), {{ settings.theme_max_width }}px"
          {%- endcapture -%}
        {%- endif -%}
      {%- endunless -%}

      {%- liquid
        assign block_index = section.blocks | find_index: 'id', block.id
        if section.index == 1 and block_index == 0
          assign preload = true
        else
          assign preload = false
        endif
      -%}

      {%- liquid
        assign image_class = 'lazy-image--to-reveal'

        if block.settings.mobile_image
          render 'lazy-image', image: block.settings.mobile_image, type: image_type, alt: block.settings.title, image_alignment: image_alignment, sizes: sizes, class: 'lazy-image--to-reveal element--hide-on-desk', overlay: true, preload: preload

          assign image_class = image_class | append: ' element--hide-on-small'
        endif

        render 'lazy-image', image: block.settings.image, type: image_type, alt: block.settings.title, image_alignment: image_alignment, sizes: sizes, class: image_class, overlay: true, preload: preload

        assign image_class = ''
      -%}

    {%- else -%}
      {{ 'image' | placeholder_svg_tag }}
    {%- endunless -%}
  </div>

  {%- render 'custom-colors',
    id: block.id,
    text: block.settings.color_text_main,
    background: block.settings.color_background_main,
    hide_borders: section.settings.color_hide_borders,
    border_radius: section.settings.border_radius
  -%}
</div>

{% schema %}
{
  "name": "t:sections.local-extra-words.sections.slideshow.block.name",
  "tag": null,
  "blocks": [{ "type": "@app" }, { "type": "@theme" }],
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.gallery.blocks.image.settings.image.label"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "t:sections.image.mobile_image"
    },
    {
      "type": "url",
      "id": "link",
      "label": "t:sections.image-with-text.blocks.image.settings.url.label",
      "info": "t:theme_blocks.slide_image.settings.info"
    },
    {
      "type": "checkbox",
      "id": "open_in_new_window",
      "visible_if": "{{ block.settings.link != blank }}",
      "label": "t:sections.local-extra-words.sections.announcement-bar.blocks.content.settings.target",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.bundle-extra-words.settings_schema.card.settings.style.header"
    },
    {
      "type": "color",
      "id": "color_background_main",
      "alpha": true,
      "label": "t:sections.local-extra-words.settings_schema.colors.settings.overlay",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "color_text_main",
      "label": "t:sections.split-extra-words.settings_schema.colors.settings.text",
      "default": "rgba(0,0,0,0)"
    }
  ],
  "presets": [
    {
      "name": "t:sections.local-extra-words.sections.slideshow.block.name",
      "blocks": [
        {
          "type": "heading"
        },
        {
          "type": "caption"
        },
        {
          "type": "content-group",
          "blocks": [
            {
              "type": "button",
              "settings": {
                "button_label": "Button label",
                "button_style": "solid"
              }
            },
            {
              "type": "button",
              "settings": {
                "button_label": "Button label",
                "button_style": "outline"
              }
            }
          ]
        }
      ]
    }
  ]
}
{% endschema %}
